(()=>{"use strict";function e(e,t,o){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(o.inputErrorClass),n.classList.remove(o.errorClass),n.textContent=""}function t(e,t,o){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(o.inactiveButtonClass)):(t.disabled=!0,t.classList.add(o.inactiveButtonClass))}function o(o,n){var r=Array.from(o.querySelectorAll(n.inputSelector));r.forEach((function(t){return e(o,t,n)})),t(r,o.querySelector(n.submitButtonSelector),n)}function n(e){e.classList.add("popup_opened"),document.addEventListener("keydown",c)}function r(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",c)}function c(e){"Escape"===e.key&&r(document.querySelector(".popup_opened"))}function u(e){e.target.classList.contains("popup_opened")&&r(document.querySelector(".popup_opened"))}var i=document.getElementById("popup-card"),a=document.querySelector("#card").content,s=document.querySelector(".elements__list"),l=document.getElementById("popup-image"),p=l.querySelector(".popup__caption"),d=l.querySelector(".popup__picture");function f(e,t){var o=function(e,t){var o=a.querySelector(".elements__element").cloneNode(!0),r=o.querySelector(".elements__image");return o.querySelector(".elements__text").textContent=e,r.src=t,r.alt=e,r.addEventListener("click",(function(){var o,r,c;n(l),o=t,r=e,c=e,p.textContent=r,d.src=o,d.alt=c})),o.querySelector(".elements__like").addEventListener("click",(function(e){e.target.classList.toggle("elements__like_active")})),o.querySelector(".elements__delete").addEventListener("click",(function(){o.remove()})),o}(e,t);s.insertAdjacentElement("afterbegin",o)}var m=document.getElementById("popup-profile"),_=document.querySelector(".profile"),v=_.querySelector(".profile__name"),y=_.querySelector(".profile__profession"),S=_.querySelector(".profile__photo"),h=document.getElementById("popup-avatar"),q=function(){return fetch("https://nomoreparties.co/v1/plus-cohort-15/users/me",{headers:{authorization:"bfe9fc91-7210-42ab-9043-e5db917b2ecc"}}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){b(e.name,e.about,e.avatar)}))},b=function(e,t,o){v.textContent=e,y.textContent=t,S.src=o};var E,L=document.querySelectorAll(".popup"),C=h.querySelector(".popup__form").querySelector(".popup__item_el_avatar"),k=m.querySelector(".popup__form"),g=k.querySelector(".popup__item_el_name"),A=_.querySelector(".profile__avatar"),B=m.querySelector(".popup__item_el_profession"),j=i.querySelector(".popup__item_el_name"),x=i.querySelector(".popup__item_el_profession"),z=i.querySelector(".popup__form"),I=document.querySelector(".button_type_add"),P=document.querySelectorAll(".button_type_close"),w=document.querySelector(".button_type_edit"),D={formSelector:".popup__form",inputSelector:".popup__item",submitButtonSelector:".button_type_save",inactiveButtonClass:"button_type_save_inactive",inputErrorClass:"popup__item_type_error",errorClass:"popup__item-error_active"};fetch("https://nomoreparties.co/v1/plus-cohort-15/cards",{headers:{authorization:"bfe9fc91-7210-42ab-9043-e5db917b2ecc"}}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){!function(e,t){e.map((function(e){t(e.name,e.link)}))}(e,f)})),q(),E=D,Array.from(document.querySelectorAll(E.formSelector)).forEach((function(o){!function(o,n){var r=Array.from(o.querySelectorAll(n.inputSelector)),c=o.querySelector(n.submitButtonSelector);t(r,c,n),r.forEach((function(u){u.addEventListener("input",(function(){!function(t,o,n){o.validity.patternMismatch?o.setCustomValidity(o.dataset.errorMessage):o.setCustomValidity(""),o.validity.valid?e(t,o,n):function(e,t,o,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(n.inputErrorClass),r.textContent=o,r.classList.add(n.errorClass)}(t,o,o.validationMessage,n)}(o,u,n),t(r,c,n)}))}))}(o,E)})),L.forEach((function(e){e.addEventListener("mousedown",u)})),P.forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){r(t)}))})),w.addEventListener("click",(function(){o(m,D),n(m)})),I.addEventListener("click",(function(){o(i,D),n(i)})),A.addEventListener("click",(function(){o(h,D),n(h)})),k.addEventListener("submit",(function(e){var t,o;e.preventDefault(),t=g.value,o=B.value,function(e,t){fetch("https://nomoreparties.co/v1/plus-cohort-15/users/me",{method:"PATCH",headers:{authorization:"bfe9fc91-7210-42ab-9043-e5db917b2ecc","content-type":"application/json"},body:JSON.stringify({name:e,about:t})})}(t,o),q(),r(m)})),h.addEventListener("submit",(function(e){e.preventDefault(),function(e){S.src=e,r(h)}(C.value)})),z.addEventListener("submit",(function(e){e.preventDefault(),function(e,t){fetch("https://nomoreparties.co/v1/plus-cohort-15/cards",{method:"POST",headers:{authorization:"bfe9fc91-7210-42ab-9043-e5db917b2ecc","content-type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((function(e){return e.json()})).then((function(e){f(e.name,e.link)})).catch((function(e){console.error("Error",e)}))}(j.value,x.value),e.target.reset(),r(i)}))})();